<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>API Simples</title>
</head>

<body>
    <h1>Usuários</h1>

    <button onclick="listarUsuarios()">Listar Usuários</button>
    <pre id="resultado"></pre>

    <h2>Criar Usuário</h2>
    <input type="number" id="id" placeholder="ID">
    <input type="text" id="nome" placeholder="Nome">
    <input type="number" id="idade" placeholder="Idade">
    <button onclick="criarUsuario()">Criar</button>

    <h2> Remover Usuario</h2>
    <input type="number" id="idDeletar" placeholder="ID">
    <button onclick="deletarUsuario()">Deletar</button>


    <script>
        const API_URL = 'http://127.0.0.1:8000';

        async function listarUsuarios() {
            const resposta = await fetch(`${API_URL}/usuarios`);
            const dados = await resposta.json();
            document.getElementById('resultado').textContent = JSON.stringify(dados, null, 2);
        }

        async function criarUsuario() {
            const id = parseInt(document.getElementById('id').value);
            const nome = document.getElementById('nome').value;
            const idade = parseInt(document.getElementById('idade').value);

            const resposta = await fetch(`${API_URL}/usuarios`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ id, nome, idade })
            });

            const dados = await resposta.json();
            console.log("Resposta do POST:", dados);

            listarUsuarios();
        }

        async function deletarUsuario() {
            const id = parseInt(document.getElementById('idDeletar').value);

            const resposta = await fetch(`${API_URL}/usuarios/${id}`, {
                method: 'DELETE'
            });

            const dados = await resposta.json();
            alert(dados.mensagem);  // mostra se foi removido ou não

            listarUsuarios(); // atualiza a lista de usuários
        }
    </script>
</body>

</html>